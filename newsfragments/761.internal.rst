Fix raw format reading in identify/push protocol and add comprehensive test coverage for both varint and raw formats
