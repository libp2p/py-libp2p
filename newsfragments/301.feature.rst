Migrated remaining asyncio usage with trio, so the codebase uses a single async runtime.
